<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
<!-- BEGIN: Head-->

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6EJRXTPH3Z"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6EJRXTPH3Z');
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="PixelPlush is a Game Studio started by Maaya and Instafluff building feel-good, relaxing and fun games">
    <meta name="keywords" content="pixelplush, game, development, studio, instafluff, maaya, art, web, dev, fun, relax, play">
    <meta name="author" content="PixelPlush">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" content="PixelPlush is a Game Studio started by Maaya and Instafluff building feel-good, relaxing and fun games">
    <meta name="twitter:image" content="https://www.pixelplush.dev/public/app-assets/images/logo/silhouette.png">
    <meta name="twitter:creator" content="PixelPlushGames">
    <meta name="twitter:title" content="PixelPlush Studio - Games to Relax and Play Made By Maaya and Instafluff">
    <meta property="og:type" content="website">
    <meta property="og:description" content="PixelPlush is a Game Studio started by Maaya and Instafluff building feel-good, relaxing and fun games">
    <meta property="og:image" content="https://www.pixelplush.dev/public/app-assets/images/logo/silhouette.png">
    <meta property="og:url" content="https://www.pixelplush.dev">
    <!-- <meta property="og:title" content="PixelPlush Studio - Games to Relax and Play Made By Maaya and Instafluff"> -->
    <title>Stream Game Overlay Link Generator - PixelPlush Studio - Games to Relax and Play Made By Maaya and Instafluff</title>
    <!-- <link rel="apple-touch-icon" href="public/app-assets/images/ico/apple-icon-120.png"> -->
    <link rel="shortcut icon" type="image/x-icon" href="public/app-assets/images/ico/favicon.ico">
    <link href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600%7CIBM+Plex+Sans:300,400,500,600,700" rel="stylesheet">

    <!-- BEGIN: Vendor CSS-->
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/vendors.min.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/forms/spinner/jquery.bootstrap-touchspin.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/charts/apexcharts.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/extensions/swiper.min.css">
    <!-- END: Vendor CSS-->

    <!-- BEGIN: Theme CSS-->
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/bootstrap-extended.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/colors.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/components.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/themes/dark-layout.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/themes/semi-dark-layout.css">
    <!-- END: Theme CSS-->

    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/pages/dashboard-ecommerce.css">
    <!-- END: Page CSS-->

    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="public/assets/css/style.css">
    <!-- END: Custom CSS-->

</head>
<!-- END: Head-->

<!-- BEGIN: Body-->

<body class="vertical-layout vertical-menu-modern 1-column  navbar-sticky footer-static  fixed-footer" data-open="click" data-menu="vertical-menu-modern" data-col="1-column">

    <!-- BEGIN: Header-->
    <div class="header-navbar-shadow"></div>
    <nav class="header-navbar main-header-navbar navbar-expand-lg navbar navbar-with-menu fixed-top ">
        <div class="navbar-wrapper">
            <div class="navbar-container content">
                <div class="navbar-collapse" id="navbar-mobile">
                    <div class="mr-auto float-left bookmark-wrapper d-flex align-items-center">
                        <ul class="nav navbar-nav">
                            <li class="nav-item mr-auto"><a class="navbar-brand" href="index.html">
                                <h2 class="brand-text mb-0"><img src="public/app-assets/images/logo/logo.png" height="27px" class="img-responsive"> <img src="public/app-assets/images/logo/text.png" height="27px" class="img-responsive"></h2>
                            </a></li>
                        </ul>
                    </div>
                    <ul class="nav navbar-nav float-right">
                        <li class="nav-item d-none d-lg-block"><span>Games to Relax and Play<i class="bx bxs-heart pink mx-50 font-small-3"></i>Made By <a href="https://twitch.tv/maayainsane" target="_blank"><img src="public/app-assets/images/icon/maaya.gif" height="32px"> Maaya</a> &amp; <a href="https://twitch.tv/instafluff" target="_blank">Instafluff <img src="public/app-assets/images/icon/instafluff.gif" height="34px"></a></span></li>
                        <li>&nbsp;</li>
                        <li class="nav-item d-none d-lg-block">
                            <div class="not-logged-in">
                                <a id="login" href="#" class="btn btn-primary mr-25">Log In</a>
                            </div>
                            <div class="logged-in">
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    <!-- END: Header-->

    <!-- BEGIN: Content-->
    <div class="app-content content">
        <div class="content-overlay"></div>
        <div class="content-wrapper">
            <div class="content-header row">
            </div>
            <div class="content-body">
                <section class="users-edit">
                    <div class="card">
                        <div class="card-content">
                            <div class="card-body">
                                <ul class="nav nav-tabs mb-2" role="tablist">
                                    <li class="nav-item current">
                                        <a class="nav-link d-flex align-items-center active" id="account-tab" data-toggle="tab" href="#" aria-controls="account" role="tab" aria-selected="true">
                                            <i class="bx bx-cart mr-25"></i><span class="d-none d-sm-block">PixelPlush Goodies Market</span>
                                        </a>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="account" aria-labelledby="account-tab" role="tabpanel">
                                        <!-- users edit media object start -->
                                        <div class="media mb-2">
                                            <a class="mr-2" href="#">
                                                <img id="account-image" src="public/app-assets/images/icon/icons8-cat-profile-64.png" alt="users avatar" class="users-avatar-shadow rounded-circle" height="64" width="64">
                                            </a>
                                            <div class="media-body">
                                                <h4 id="account-username" class="media-heading">Not Logged In</h4>
                                                <div class="col-12 px-0 d-flex">
                                                    <a id="logout" href="#" class="btn btn-sm btn-light-secondary logged-in">Logout</a>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- users edit media object ends -->
                                        <!-- users edit account form start -->
                                        <form novalidate="">
                                            <div class="row">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <div class="controls">
                                                            <label>Your PixelPlush Wallet</label>
                                                            <div class="input-group">
                                                                <input id="pixelplush-coins" type="text" class="form-control" value="" readonly>
                                                                <div class="input-group-append">
                                                                    <button id="test-coin-add" class="btn btn-secondary"><img src="https://pixelplush.dev/assets/icons/golden_coin/golden_coin1.png" /></button>
                                                                </div>
                                                            </div>
                                                        <div class="help-block"></div></div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Choose Item Type</label>
                                                        <select class="form-control" id="inputItemType">
                                                          <option value="character">Character</option>
                                                          <option value="pet">Pet</option>
                                                          <option value="outfit">Outfit</option>
                                                        </select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label>Item</label>
                                                        <select class="form-control" id="inputItemList">
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6 text-center">
                                                    <img id="game-preview" src="" height="220" width="220" class="img-fluid" alt="Game Preview" />
                                                </div>
                                                <div class="col-12">
                                                    <div class="form-group">
                                                        <button class="btn btn-success" type="button" id="buy-btn">Buy Item</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                        <!-- users edit account form ends -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
    <!-- END: Content-->

    </div>
    <div class="sidenav-overlay"></div>
    <div class="drag-target"></div>

    <!-- BEGIN: Footer-->
    <footer class="footer footer-static footer-light">
        <p class="clearfix mb-0"><span class="float-left d-inline-block">Join our Discord and hang out with us! <a href="https://pixelplush.dev/discord" target="_blank"><u>https://pixelplush.dev/discord</u></a></span>
          <span class="float-right d-inline-block"><script>document.write(new Date().getFullYear());</script> &copy; PIXELPLUSH&trade;</span>
            <button class="btn btn-primary btn-icon scroll-top" type="button"><i class="bx bx-up-arrow-alt"></i></button>
        </p>
    </footer>
    <!-- END: Footer-->


    <!-- BEGIN: Vendor JS-->
    <script src="public/app-assets/vendors/js/vendors.min.js"></script>
    <script src="public/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.tools.js"></script>
    <script src="public/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.defaults.js"></script>
    <script src="public/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.min.js"></script>
    <!-- BEGIN Vendor JS-->

    <!-- BEGIN: Page Vendor JS-->
    <script src="public/app-assets/vendors/js/charts/apexcharts.min.js"></script>
    <script src="public/app-assets/vendors/js/extensions/swiper.min.js"></script>
    <script src="public/app-assets/vendors/js/forms/spinner/jquery.bootstrap-touchspin.js"></script>
    <!-- END: Page Vendor JS-->

    <!-- BEGIN: Theme JS-->
    <script src="public/app-assets/js/scripts/configs/vertical-menu-light.js"></script>
    <script src="public/app-assets/js/core/app-menu.js"></script>
    <script src="public/app-assets/js/core/app.js"></script>
    <script src="public/app-assets/js/scripts/components.js"></script>
    <script src="public/app-assets/js/scripts/footer.js"></script>
    <!-- END: Theme JS-->

    <script src="public/app-assets/js/scripts/forms/number-input.js"></script>

    <script src="public/comfytwitch.min.js"></script>
    <script>
        const params = new URLSearchParams( location.search );
        const clientId = "8m07ghhogjy0q09moeunnpdu51i60n";
        const baseUrl = window.location.origin;
        const plushApiUrl = "https://blockparty.instafluff.tv:3000/v1"; //"http://localhost:3000/v1";
        let twitch = {};
        let account = {};
        let catalog = {};

        document.querySelector( "#inputItemType" ).addEventListener( "change", ( e ) => {
            // console.log( e, "changed" );
            populateItemList();
        });

        document.querySelector( "#inputItemList" ).addEventListener( "change", ( e ) => {
            console.log( "changed" );
        });

        document.querySelector( "#test-coin-add" ).addEventListener( "click", async ( e ) => {
            let result = await fetch( `${plushApiUrl}/accounts/coins/add`, {
                method: "POST",
                headers: {
                    Twitch: ComfyTwitch.Token,
                    PixelPlushAPI: "testapikey",
                },
                body: JSON.stringify( {
                    coins: 50
                })
            } );
            console.log( "added!", result );
            window.location.reload();
        });

        document.querySelector( "#buy-btn" ).addEventListener( "click", async ( e ) => {
            console.log( document.querySelector( "#inputItemList" ).value );
            let result = await fetch( `${plushApiUrl}/shop/buy`, {
                method: "POST",
                headers: {
                    Twitch: ComfyTwitch.Token,
                },
                body: JSON.stringify( {
                    item: document.querySelector( "#inputItemList" ).value
                })
            } ).then( r => r.json() );
            console.log( "buying!", result );
            window.location.reload();
        });

        $( ".not-logged-in" ).show();
        $( ".logged-in" ).hide();

        ComfyTwitch.Check()
        .then( async result => {
            // console.log( result );
            if( result ) {
                try {
                    account = await fetch( `${plushApiUrl}/accounts`, {
                        headers: {
                            Twitch: result.token
                        }
                    } ).then( r => r.json() );

                    console.log( account );

                    if( account.error ) {
                        throw "Login Error";
                    }

                    $( ".not-logged-in" ).hide();
                    $( ".logged-in" ).show();

                    document.querySelector( "#account-image" ).setAttribute( "src", account.profileImage );
                    document.querySelector( "#account-username" ).innerText = account.displayName || account.username;
                    // document.querySelector( "#userid" ).innerText = r.key;
                    document.querySelector( "#pixelplush-coins" ).setAttribute( "value", account.coins );

                    catalog = await fetch( "https://www.pixelplush.dev/assets/catalog.json", {
                    }).then( r => r.json() );

                    console.log( catalog );

                    // Populate Catalog
                    // $( "#inputItemList" ).empty();

                    // inputItemList
                    document.querySelector( "#inputItemType" ).value = "character";
                    populateItemList();

                    document.querySelector( "#logout" ).addEventListener( "click", function() {
                        ComfyTwitch.Logout();
                        window.location.reload();
                    });
                }
                catch( error ) {
                    // TODO: Auth Failed
                    console.log( "Auth Validate Failed", error );
                };
            }
            else {
                $( ".not-logged-in" ).show();
                $( ".logged-in" ).hide();

                document.querySelector( "#login" ).addEventListener( "click", function() {
                    console.log( "Logging in!" );
                    localStorage.setItem( "redirectPage", window.location.href );
                    ComfyTwitch.Login( clientId, `${baseUrl}/redirect.html`, [ "user:read:email", "chat:read", "chat:edit" ] );
                });
            }
        });

        $( document ).ready(function() {

        });

        function populateItemList() {
            let itemType = document.querySelector( "#inputItemType" );
            let itemList = document.querySelector( "#inputItemList" );
            itemList.innerText = null;
            catalog.forEach( ( item, index ) => {
                if( item.type === itemType.value ) {
                    let option = document.createElement( "option" );
                    option.value = item.id;
                    option.innerText = `${item.name} (${item.cost} Plush Coins)`;
                    itemList.appendChild( option );
                }
            });
        }
    </script>

</body>
<!-- END: Body-->

</html>
